<section id="featured-portfolio" class="featured-portfolio-section py-20 md:py-28 bg-charcoal relative overflow-hidden">
  <!-- Background decorative elements -->
  <div class="absolute inset-0 bg-gradient-to-b from-charcoal via-charcoal-light to-charcoal pointer-events-none" aria-hidden="true"></div>
  <div class="absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,hsl(var(--gold)/0.05),transparent_70%)] pointer-events-none" aria-hidden="true"></div>
  
  <div class="container mx-auto px-4 md:px-6 relative z-10">
    <!-- Section Header -->
    <div class="text-center mb-12 md:mb-16" @fadeInUp>
      <span class="text-gold text-xs md:text-sm uppercase tracking-[0.3em] font-sans mb-3 md:mb-4 inline-block">Featured Portfolio</span>
      <h2 class="font-serif text-3xl md:text-4xl lg:text-5xl text-white mb-3 md:mb-4 font-bold">
        Featured <span class="text-gradient-gold">Listings</span>
      </h2>
      <div class="w-16 md:w-24 h-0.5 md:h-1 gold-gradient mx-auto rounded-full shadow-lg shadow-gold/30" aria-hidden="true"></div>
    </div>

    <!-- Main Content: Left (Listings Boxes) + Right (Portrait Carousel) -->
    <div class="flex flex-col lg:flex-row gap-8 lg:gap-12 items-start justify-center max-w-7xl mx-auto">
      
      <!-- Left Side: Listings Boxes with Dates -->
      <div class="featured-listings-left w-full lg:w-2/5 lg:max-w-md" #listingsContainer>
        <div class="space-y-4">
          @for (listing of listings; track listing.id; let i = $index) {
            <div
              class="listing-box group relative cursor-pointer transition-all duration-300"
              [class.active]="selectedListing?.id === listing.id"
              (click)="selectListing(listing, i)"
              [@fadeInUp]
              [style.animation-delay]="(i * 50) + 'ms'"
            >
              <!-- Date Badge -->
              <div class="listing-date-badge absolute -left-2 top-4 z-20">
                <div class="date-badge-content bg-gold text-charcoal text-xs font-bold px-3 py-1.5 rounded-r-lg shadow-lg">
                  {{ listing.date }}
                </div>
              </div>

              <!-- Listing Card -->
              <div class="listing-card bg-charcoal-light/80 backdrop-blur-sm border-2 rounded-xl p-5 pl-16 md:pl-20 transition-all duration-300"
                   [class.border-gold]="selectedListing?.id === listing.id"
                   [class.border-white/10]="selectedListing?.id !== listing.id"
                   [class.shadow-xl]="selectedListing?.id === listing.id"
                   [class.shadow-lg]="selectedListing?.id !== listing.id"
                   [class.active-card]="selectedListing?.id === listing.id">
                
                <!-- Category Tag -->
                <div class="flex items-center justify-between mb-2">
                  <span class="listing-category text-gold/80 text-xs font-sans uppercase tracking-wider">
                    {{ listing.category }}
                  </span>
                  @if (selectedListing?.id === listing.id) {
                    <div class="w-2 h-2 rounded-full bg-gold animate-pulse" aria-hidden="true"></div>
                  }
                </div>

                <!-- Property Name -->
                <h3 class="font-serif text-lg md:text-xl text-white mb-1 group-hover:text-gold transition-colors duration-300">
                  {{ listing.name }}
                </h3>

                <!-- Location -->
                <p class="text-white/60 text-sm font-sans mb-2 flex items-center gap-1.5">
                  <lucide-icon name="map-pin" class="w-3 h-3 text-gold/60" stroke-width="2"></lucide-icon>
                  <span>{{ listing.location }}</span>
                </p>

                <!-- Configuration & Price -->
                <div class="flex items-center justify-between pt-2 border-t border-white/10">
                  <span class="text-white/70 text-sm font-sans">{{ listing.configuration }}</span>
                  <span class="text-gold font-serif text-lg md:text-xl font-bold">{{ listing.price }}</span>
                </div>
              </div>
            </div>
          }
        </div>
      </div>

      <!-- Right Side: Portrait Image Carousel -->
      <div class="featured-carousel-right w-full lg:w-3/5 lg:max-w-2xl">
        <div class="portrait-carousel-wrapper relative">
          <!-- Main Carousel Image -->
          <div class="portrait-carousel-main relative rounded-2xl overflow-hidden shadow-2xl border-2 border-gold/20 bg-charcoal-light"
               [@slideIn]>
            <div class="aspect-[3/4] relative">
              <img
                [src]="selectedListing?.image || listings[0].image"
                [alt]="selectedListing?.name || listings[0].name"
                class="w-full h-full object-cover transition-transform duration-700"
                loading="lazy"
              />
              <!-- Gradient overlay -->
              <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent pointer-events-none" aria-hidden="true"></div>
              
              <!-- Property Info Overlay -->
              <div class="absolute bottom-0 left-0 right-0 p-6 md:p-8 text-white z-10">
                <div class="flex items-center gap-2 mb-2">
                  <span class="text-gold text-xs font-sans uppercase tracking-wider">{{ selectedListing?.category }}</span>
                  <span class="text-white/40">â€¢</span>
                  <span class="text-white/70 text-xs">{{ selectedListing?.date }}</span>
                </div>
                <h3 class="font-serif text-2xl md:text-3xl font-bold mb-2">{{ selectedListing?.name }}</h3>
                <p class="text-white/80 text-sm md:text-base mb-3 flex items-center gap-2">
                  <lucide-icon name="map-pin" class="w-4 h-4 text-gold" stroke-width="2"></lucide-icon>
                  {{ selectedListing?.location }}
                </p>
                <div class="flex items-center justify-between pt-3 border-t border-white/20">
                  <span class="text-white/70 text-sm">{{ selectedListing?.configuration }}</span>
                  <span class="text-gold font-serif text-2xl md:text-3xl font-bold">{{ selectedListing?.price }}</span>
                </div>
              </div>
            </div>

            <!-- Navigation Arrows -->
            <button
              (click)="previous()"
              (mouseenter)="stopAutoSlide()"
              (mouseleave)="startAutoSlide()"
              class="carousel-nav-btn carousel-nav-left absolute left-4 top-1/2 -translate-y-1/2 z-20 w-12 h-12 rounded-full bg-black/60 hover:bg-black/80 backdrop-blur-sm border border-gold/40 hover:border-gold/60 flex items-center justify-center transition-all duration-300 group shadow-xl"
              aria-label="Previous image"
            >
              <lucide-icon name="chevron-left" class="w-6 h-6 text-gold group-hover:text-gold-light transition-colors" stroke-width="2.5"></lucide-icon>
            </button>

            <button
              (click)="next()"
              (mouseenter)="stopAutoSlide()"
              (mouseleave)="startAutoSlide()"
              class="carousel-nav-btn carousel-nav-right absolute right-4 top-1/2 -translate-y-1/2 z-20 w-12 h-12 rounded-full bg-black/60 hover:bg-black/80 backdrop-blur-sm border border-gold/40 hover:border-gold/60 flex items-center justify-center transition-all duration-300 group shadow-xl"
              aria-label="Next image"
            >
              <lucide-icon name="chevron-right" class="w-6 h-6 text-gold group-hover:text-gold-light transition-colors" stroke-width="2.5"></lucide-icon>
            </button>

            <!-- Image Counter -->
            <div class="absolute top-4 right-4 z-20 px-4 py-2 rounded-full bg-black/70 backdrop-blur-sm border border-gold/30">
              <span class="text-white text-sm font-sans">
                {{ currentIndex + 1 }} / {{ listings.length }}
              </span>
            </div>
          </div>

          <!-- Thumbnail Strip (Portrait) -->
          <div class="portrait-thumbnails mt-6 overflow-x-auto scrollbar-hide pb-2">
            <div class="flex gap-3 justify-center min-w-max px-2">
              @for (listing of listings; track listing.id; let i = $index) {
                <button
                  (click)="goToSlide(i)"
                  class="portrait-thumbnail flex-shrink-0 rounded-lg overflow-hidden border-2 transition-all duration-300"
                  [class.border-gold]="i === currentIndex"
                  [class.border-white/20]="i !== currentIndex"
                  [class.opacity-60]="i !== currentIndex"
                  [class.opacity-100]="i === currentIndex"
                  [class.scale-105]="i === currentIndex"
                  aria-label="Go to {{ listing.name }}"
                >
                  <div class="w-16 h-20 md:w-20 md:h-28 relative">
                    <img
                      [src]="listing.image"
                      [alt]="listing.name"
                      class="w-full h-full object-cover"
                      loading="lazy"
                    />
                    @if (i === currentIndex) {
                      <div class="absolute inset-0 bg-gold/20 pointer-events-none" aria-hidden="true"></div>
                    }
                  </div>
                </button>
              }
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
